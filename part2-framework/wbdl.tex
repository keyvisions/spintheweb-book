% Chapter 5: Webbase Description Language (WBDL)

\chapter{Webbase Description Language (WBDL)}
\label{chap:wbdl}

\begin{quote}
\textit{"The limits of my language mean the limits of my world."} \\
â€” Ludwig Wittgenstein
\end{quote}

\wbdl{} is formally defined using the standard \textbf{JSON Schema}.

\section{WBDL Ecosystem}
\label{sec:wbdl-ecosystem}

While \wbdl{} serves as the declarative language for describing portals, it operates within a comprehensive ecosystem of associated technologies and APIs that enhance its capabilities:

\subsection{Layout API}
\label{sec:layout-api}

\wbdl{} includes an associated Layout API that provides programmatic control over content presentation and styling. This API works in conjunction with the declarative \texttt{STWLayout} elements to enable:

\begin{itemize}
\item Dynamic layout adjustments based on content type and user preferences
\item Responsive design patterns that adapt to different screen sizes and devices
\item Integration with external CSS frameworks and design systems
\item Runtime modification of layout properties based on data characteristics
\end{itemize}

The Layout API ensures that content presentation remains consistent across different contexts while allowing for necessary flexibility in complex enterprise environments.

\subsection{Text Preprocessor}
\label{sec:text-preprocessor}

The \wbdl{} text preprocessor is a powerful engine that processes textual content before rendering, enabling:

\begin{itemize}
\item Placeholder substitution using the \textbf{Webbase Placeholders Language (\wbpl{})}
\item Localization and internationalization support
\item Dynamic text generation based on context and user data
\item Integration with external content management systems
\item Markdown and other markup language processing
\end{itemize}

This preprocessor is particularly crucial for the \texttt{command} attributes in \texttt{STWContent} elements, where it replaces placeholders with actual values from various sources before command execution.

\subsection{Visual Component Library (VCL)}
\label{sec:vcl}

The Visual Component Library provides a standardized set of UI components that correspond to the different content categories and subtypes. The VCL ensures:

\begin{itemize}
\item Consistent visual presentation across different portal implementations
\item Accessibility compliance through standardized component behavior
\item Cross-platform compatibility for various front-end frameworks
\item Extensibility for custom component development
\end{itemize}

\subsection{Content Management Integration}
\label{sec:cms-integration}

\wbdl{} is designed as a fundamental language for Content Management Systems (CMS), providing:

\begin{itemize}
\item Structured content definition that separates presentation from data
\item Version control capabilities for portal configurations
\item Workflow management for content approval processes
\item Integration points for external content repositories
\end{itemize}

This integration capability makes \wbdl{} particularly suitable for enterprise environments where content management workflows are critical to business operations.

\section{Spin the Web Studio}
\label{sec:studio}

The third and final component of Spin the Web is the \textbf{Spin the Web Studio}. Alongside the \textbf{\wbdl{}} and the \textbf{Web Spinner}, it completes the framework. The Spin the Web Studio is a specialized \webbaselet{} engineered for editing \webbase{s}. To use it, you simply add the \webbaselet{} to the \webbase{} you wish to edit, enabling direct, in-place modification.

\section{The STWElement Base}
\label{sec:stwelement-base}

\wbdl{} defines a base element, \texttt{STWElement}, from which all other elements inherit. JSON Schema definitions for \wbdl{} elements are in \Cref{app:wbdl-json-schema} (see Appendix: WBDL JSON Schema Reference).

\subsection{Property Description}

\begin{description}
\item[\textbf{\_id}]: A unique identifier for the element (GUID).
\item[\textbf{type}]: The specific type of the element. Can be one of 'Site', 'Area', 'Page', or 'Content'.
\item[\textbf{name}]: A localizable name for the element. This is a JSON object where keys are language codes (e.g., "en", "it") and values are the translated strings. Example: \lstinline[language=JSON]|{"en": "Research & Development", "it": "Ricerca e Sviluppo"}|
\item[\textbf{slug}]: A localizable, URL-friendly version of the name. It is a JSON object with the same structure as \texttt{name}. Slugs should contain only lowercase letters, numbers, and hyphens.
\item[\textbf{keywords}]: Localizable keywords for SEO. Follows the same structure as \texttt{name}.
\item[\textbf{description}]: A localizable description of the element. Follows the same structure as \texttt{name}.
\item[\textbf{visibility}]: Defines the visibility rules for the element based on user roles. It contains a set of rules, where each rule assigns \texttt{true} (visible) or \texttt{false} (not visible) to a specific role. If a rule for a role is not defined (is \texttt{null}), the visibility is determined by checking the parent element's visibility rules. This hierarchical check continues up to the root element. If no rule is found, the element is not visible by default.
\item[\textbf{children}]: A list of child \texttt{STWElement} objects.
\end{description}

\section{WBDL Element Types}
\label{sec:wbdl-element-types}

This section describes the specialized element types available in \wbdl{}.

\subsection{STWSite}

\texttt{STWSite} is a singleton element that represents the entire portal. It inherits from \texttt{STWElement} and acts as the root element of the portal structure.

\subsubsection{Property Description}

\begin{description}
\item[\textbf{langs}]: A list of supported languages for the site. The first of the list is the default site language.
\item[\textbf{datasources}]: Defines the data sources used by the portal.
\item[\textbf{mainpage}]: The GUID of the \texttt{STWPage} that serves as the main entry point for the site.
\item[\textbf{version}]: A version string for the site.
\end{description}

\subsubsection{Data Sources and Groups}
\label{sec:datasources-groups}

The \texttt{datasources} element within \texttt{STWSite} provides a flexible framework for defining how the portal connects to and manages external data systems. Beyond simple connection definitions, \wbdl{} supports advanced data organization concepts:

\begin{description}
\item[\textbf{Data Source Configuration}]: Each data source can be configured with specific connection parameters, authentication credentials, and command optimization settings. Supported data source types include:
\begin{itemize}
\item Relational databases (SQL-based)
\item NoSQL databases (document, key-value, graph)
\item REST APIs and web services
\item File-based data sources (CSV, JSON, XML)
\item Enterprise systems (ERP, CRM, HRM)
\end{itemize}

\item[\textbf{Data Groups}]: Data sources can be organized into logical groups that facilitate:
\begin{itemize}
\item Access control and security policies
\item Performance optimization through connection pooling
\item Load balancing across redundant data sources
\item Backup and failover configurations
\item Administrative grouping for different business units
\end{itemize}

\item[\textbf{Accessibility Integration}]: The data source framework includes provisions for accessibility compliance:
\begin{itemize}
\item Metadata enrichment for screen readers and assistive technologies
\item Alternative data representations for different accessibility needs
\item Command result formatting that supports accessibility standards
\item Integration with accessibility frameworks and tools
\end{itemize}
\end{description}

This comprehensive approach to data source management ensures that \wbdl{} can integrate seamlessly with complex enterprise data environments while maintaining accessibility and security standards.

\subsection{STWArea}

\texttt{STWArea} represents a logical grouping of pages, analogous to a chapter in a book. It extends the base \texttt{STWElement}.

\subsubsection{Property Description}

\begin{description}
\item[\textbf{mainpage}]: The GUID of the \texttt{STWPage} that serves as the main entry point for this area.
\item[\textbf{version}]: A version string for the area.
\end{description}

\subsection{STWPage}

\texttt{STWPage} represents a single page in the portal. It extends the base \texttt{STWElement} but restricts its \texttt{children} to only \texttt{STWContent} elements.

\subsection{STWContent}

\texttt{STWContent} represents a piece of content on a page. It extends the base \texttt{STWElement} but is not allowed to have any \texttt{children}. It adds several attributes for data binding and layout control.

\subsubsection{Property Description}

\begin{description}
\item[\textbf{type}]: Overrides the base element's type and is fixed to "Content".
\item[\textbf{subtype}]: Specifies the type of content to be rendered, which determines the component used on the front-end. Possible values include \texttt{Text}, \texttt{Form}, \texttt{Table}, \texttt{Tree}, \texttt{Calendar}, and \texttt{Breadcrumbs}.
\item[\textbf{cssClass}]: An optional CSS class to apply to the content element for styling.
\item[\textbf{section}]: The name of the page section where this content should be rendered (e.g., "header", "main", "sidebar").
\item[\textbf{sequence}]: A number that determines the order of content within a section.
\item[\textbf{dsn}]: The "data source name," which identifies a specific data source configured in the \texttt{STWSite} element.
\item[\textbf{command}]: The command to be executed against the specified data source. Before execution, the command text is processed by the \textbf{Webbase Placeholders Language (\wbpl{})} processor. This processor replaces placeholders within the command with values sourced from several locations: the \texttt{params} attribute, the URL querystring, session variables, global variables, and HTTP headers. After this substitution, the resulting command is executed by the data source using its native language (e.g., SQL for a relational database, or JSONata if the data source is a JSON-based API).
\item[\textbf{params}]: A string containing parameters for the command, formatted as a standard querystring (e.g., \texttt{key1=value1\&key2=value2}).
\item[\textbf{layout}]: The \texttt{STWLayout} element that defines how the fetched data should be rendered.
\end{description}

\subsubsection{Content Categories}
\label{sec:content-categories}

Contents are the fundamental elements of \wbdl{} and represent interactive data units that fall into four distinct categories, each serving a specific purpose in the portal's user interface:

\begin{description}
\item[\textbf{Sensorial Contents}]: These render data in human-readable formats for information consumption and input. They include:
\begin{itemize}
\item Free text displays
\item Forms for data input
\item Lists and tables for structured data presentation
\item Plots and charts for data visualization
\item Maps for geographical data
\item Timelines for temporal data
\item Media elements (images, videos, audio)
\end{itemize}

\item[\textbf{Navigational Contents}]: These render data as interactive links and navigation elements, facilitating movement through the portal structure:
\begin{itemize}
\item Menus (primary and secondary navigation)
\item Table of contents (TOC)
\item Breadcrumbs for hierarchical navigation
\item Slicers for data filtering
\item Image maps with clickable regions
\item Pagination controls
\end{itemize}

\item[\textbf{Organizational Contents}]: These wrap and organize other contents in structured manners, providing logical grouping and presentation:
\begin{itemize}
\item Tabs for content organization
\item Calendars for date-based content
\item Trees for hierarchical data
\item Graphs for relationship visualization
\item Accordions for collapsible sections
\item Carousels for sequential content display
\end{itemize}

\item[\textbf{Special Contents}]: These provide specialized functionality and shortcuts:
\begin{itemize}
\item Shortcuts to frequently accessed content
\item Code displays with syntax highlighting
\item Embedded widgets and components
\item Custom functionality modules
\end{itemize}
\end{description}

All content types explicitly declare or request the data they interact with, and their rendering behavior is determined by their category and specific subtype. The content categorization ensures consistency in user interface patterns and enables the Web Spinner to apply appropriate rendering logic and security policies.

\subsection{STWContentWithOptions}

\texttt{STWContentWithOptions} is similar to \texttt{STWContent}, it contains a list of \texttt{option} elements (GUIDs). This type is useful for scenarios like menus and tabs where the content is sourced from other elements.

\subsubsection{Property Description}

\begin{description}
\item[\textbf{subtype}]: Specifies the type of content to be rendered. Possible values include \texttt{Menu}, \texttt{Tabs}, and \texttt{Accordion}.
\end{description}

\section{Looking Forward}
\label{sec:wbdl-forward}

A static portal, however well-structured, has limited utility in a dynamic business environment. The true power of an enterprise portal lies in its ability to present real-time, contextualized data. But how do we bridge the gap between the static structure of \wbdl{} and the dynamic data living in enterprise systems?

The next chapter introduces the \textbf{Webbase Placeholders Language (\wbpl{})}, a specialized language designed to embed dynamic queries and data-driven logic directly within your \wbdl{} definitions. We will explore how \wbpl{} turns your static templates into living, breathing documents.
